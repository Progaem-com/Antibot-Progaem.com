# Защита WordPress от ботов: от новичка до профи

WordPress — это как магнит для ботов. 40% всех сайтов в интернете работают на этой CMS, поэтому злоумышленники знают все её слабые места. За годы работы с WordPress я видел сотни атак и научился эффективно с ними бороться.

## Почему WordPress так привлекает ботов

### Открытый исходный код

WordPress — открытая система. Любой может изучить код и найти уязвимости. Это хорошо для развития, но плохо для безопасности.

### Популярные плагины

Многие плагины имеют уязвимости, которые боты активно используют. Особенно часто атакуют:
- Contact Form 7
- WooCommerce
- Yoast SEO
- Elementor

### Стандартные пути

По умолчанию WordPress использует стандартные пути: `/wp-admin/`, `/wp-login.php`, `/xmlrpc.php`. Боты знают их наизусть.

## Многоуровневая защита

### Уровень 1: Базовые настройки

**Смена стандартных путей**

Первое, что нужно сделать — изменить стандартные URL. Плагин WPS Hide Login позволяет изменить адрес входа:

```
Стандартно: yoursite.com/wp-admin/
После изменения: yoursite.com/my-secret-login/
```

**Отключение XML-RPC**

Если не используете мобильные приложения, отключите XML-RPC:

```php
// Добавьте в functions.php
add_filter('xmlrpc_enabled', '__return_false');
```

**Ограничение попыток входа**

Плагин Limit Login Attempts блокирует IP после нескольких неудачных попыток:

```php
// Настройки по умолчанию
- Максимум попыток: 4
- Время блокировки: 20 минут
- Время блокировки при превышении: 24 часа
```

### Уровень 2: Плагины безопасности

**Wordfence Security**

Самый популярный плагин безопасности. Включает:
- Firewall на уровне приложения
- Сканирование на вирусы
- Мониторинг в реальном времени
- Блокировку по IP и странам

**Sucuri Security**

Облачное решение с дополнительными возможностями:
- CDN для ускорения сайта
- DDoS-защита
- Мониторинг uptime
- Автоматическое исправление зараженных файлов

**iThemes Security**

Комплексное решение с множеством функций:
- Двухфакторная аутентификация
- Скрытие версии WordPress
- Блокировка подозрительных IP
- Резервное копирование

### Уровень 3: Серверная защита

**Настройка .htaccess**

Добавьте в файл .htaccess:

```apache
# Блокировка известных ботов
SetEnvIfNoCase User-Agent "bot|spider|crawler|scraper" bad_bot
Order Allow,Deny
Allow from all
Deny from env=bad_bot

# Защита от брутфорса
<Limit GET POST>
    order allow,deny
    allow from all
    deny from 192.168.1.100
</Limit>

# Скрытие версии WordPress
ServerTokens Prod
```

**Настройка wp-config.php**

```php
// Отключение редактирования файлов
define('DISALLOW_FILE_EDIT', true);

// Ограничение ревизий
define('WP_POST_REVISIONS', 3);

// Отключение автодобавления файлов
define('AUTOMATIC_UPDATER_DISABLED', true);
```

## Реальные кейсы

### Кейс 1: Атака через Contact Form 7

Клиент жаловался на спам через форму обратной связи. Анализ показал, что боты используют уязвимость в Contact Form 7 для отправки тысяч сообщений.

**Решение:**
1. Обновил плагин до последней версии
2. Добавил reCAPTCHA к форме
3. Настроил ограничение отправки (не более 3 сообщений в час с одного IP)

**Результат:** Спам исчез полностью.

### Кейс 2: Брутфорс-атака на админку

На корпоративном сайте зафиксировали 50 тысяч попыток входа в день. Боты пытались подобрать пароль администратора.

**Решение:**
1. Установил Wordfence Security
2. Включил двухфакторную аутентификацию
3. Изменил стандартный URL входа
4. Настроил блокировку по странам (заблокировал Китай и Россию)

**Результат:** Попытки входа сократились на 99%.

### Кейс 3: DDoS через WooCommerce

Интернет-магазин на WordPress подвергся DDoS-атаке. Боты генерировали тысячи запросов к страницам товаров.

**Решение:**
1. Подключил Cloudflare
2. Настроил кэширование страниц
3. Ограничил количество запросов с одного IP
4. Включил защиту от DDoS

**Результат:** Сайт стал работать стабильно даже под нагрузкой.

## Мониторинг и аналитика

### Логи сервера

Регулярно проверяйте логи на предмет подозрительной активности:

```bash
# Поиск попыток входа в админку
grep "wp-login.php" /var/log/apache2/access.log

# Поиск ботов по User-Agent
grep -i "bot\|spider\|crawler" /var/log/apache2/access.log
```

### Google Analytics

Настройте фильтры для исключения ботов:

1. Перейдите в "Администратор" → "Фильтры"
2. Создайте фильтр "Исключить ботов"
3. Добавьте условия:
   - Источник трафика содержит "bot"
   - User-Agent содержит "bot"

### Wordfence Live Traffic

Плагин показывает все запросы к сайту в реальном времени. Можно видеть:
- IP-адреса посетителей
- User-Agent
- Запрашиваемые страницы
- Статус блокировки

## Автоматизация защиты

### Скрипт мониторинга

Создайте скрипт для автоматической проверки логов:

```bash
#!/bin/bash
# Проверка логов на подозрительную активность

LOG_FILE="/var/log/apache2/access.log"
ALERT_EMAIL="admin@yoursite.com"

# Поиск множественных запросов с одного IP
awk '{print $1}' $LOG_FILE | sort | uniq -c | sort -nr | head -10

# Отправка уведомления при превышении лимита
if [ $(grep "$(date +%d/%b/%Y)" $LOG_FILE | awk '{print $1}' | sort | uniq -c | sort -nr | head -1 | awk '{print $1}') -gt 1000 ]; then
    echo "Подозрительная активность обнаружена!" | mail -s "Security Alert" $ALERT_EMAIL
fi
```

### Уведомления в Telegram

Настройте бота для получения уведомлений о атаках:

```php
// Добавьте в functions.php
function send_telegram_alert($message) {
    $bot_token = 'YOUR_BOT_TOKEN';
    $chat_id = 'YOUR_CHAT_ID';
    
    $url = "https://api.telegram.org/bot$bot_token/sendMessage";
    $data = [
        'chat_id' => $chat_id,
        'text' => $message
    ];
    
    wp_remote_post($url, ['body' => $data]);
}
```

## Рекомендации для новичков

### Начните с простого

1. Установите Wordfence Security
2. Включите базовые настройки
3. Настройте уведомления
4. Регулярно проверяйте отчеты

### Не переусложняйте

Не пытайтесь настроить все сразу. Лучше постепенно добавлять новые уровни защиты.

### Делайте резервные копии

Перед любыми изменениями создавайте бэкап. Один неправильный плагин может сломать весь сайт.

## Когда обращаться к профессионалам

Если:
- Сайт уже взломан
- Нет времени на настройку
- Нужна максимальная защита
- Не уверены в своих силах

То лучше доверить это специалистам. [Установка антибота](https://progaem.com/ustanovka-antibota-usluga-po-zashhite-ot-botov-vashih-sajtov-na-razlichnyh-cms-sistemah.htm) для WordPress включает анализ уязвимостей, настройку плагинов и серверную защиту.

Помните: безопасность WordPress — это не разовая настройка, а постоянный процесс. Регулярно обновляйте систему, мониторьте логи и не пренебрегайте базовыми мерами защиты.
